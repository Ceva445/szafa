{% extends "base.html" %}
{% block title %}Do zatwierdzenia ‚Äî Pending Products{% endblock %}
{% block page_title %}OBS≈ÅUGA SYSTEMU ‚Äî Produkty oczekujƒÖce{% endblock %}
{% block active %}system{% endblock %}

{% block content %}

<div class="card">

    <form method="post" id="massform">
        {% csrf_token %}
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
            <div style="display:flex; justify-content:flex-start; align-items:center; gap:10px; margin-bottom:15px;"
                class="btn-group">
                <button name="action" value="approve" class="btn primary">Zatwierd≈∫ zaznaczone</button>
                <button name="action" value="delete" class="btn danger">Usu≈Ñ zaznaczone</button>
            </div>
        </div>

        <table class="table">
            <thead>
                <tr>
                    <th><input type="checkbox" id="check-all"></th>
                    <th>Kod</th>
                    <th>Nazwa</th>
                    <th>Rozmiar</th>
                    <th>Kategoria</th>
                    <th>Cena</th>
                    <th>Okres</th>
                    <th>Min</th>
                    <th>Akcje</th>
                </tr>
            </thead>

            <tbody>
                {% for item in objects %}
                <tr>
                    <td>
                        <input type="checkbox" form="massform" name="selected" value="{{ item.id }}" class="row-check">
                    </td>

                    <td><input form="massform" type="text" name="code_{{ item.id }}" value="{{ item.code }}"
                            class="small-input"></td>
                    <td><input form="massform" type="text" name="name_{{ item.id }}" value="{{ item.name }}"
                            class="name-input"></td>
                    <td><input form="massform" type="text" name="size_{{ item.id }}" value="{{ item.size }}"
                            class="small-input"></td>

                    <td>
                        <select form="massform" name="category_{{ item.id }}" class="small-input">
  {% for cat in categories %}
    <option value="{{ cat.id }}" 
      {% if item.category and item.category.id|stringformat:"s" == cat.id|stringformat:"s" %}selected{% endif %}>
      {{ cat.name }} ({{ cat.get_type_display }})
    </option>
  {% endfor %}
</select>
                    </td>

                    <td><input form="massform" type="number" step="0.01" name="price_{{ item.id }}"
                            value="{{ item.unit_price }}" class="small-input"></td>
                    <td><input form="massform" type="number" name="period_{{ item.id }}" value="{{ item.period_days }}"
                            class="small-input"></td>
                    <td><input form="massform" type="number" name="minqty_{{ item.id }}"
                            value="{{ item.min_qty_on_stock }}" class="small-input"></td>

                    <td class="actions">
                        <form method="post" action="{% url 'core:pending_approve' item.id %}" style="display:inline;">
                            {% csrf_token %}
                            <button class="btn small">‚úîÔ∏è</button>
                        </form>
                        <form method="post" action="{% url 'core:pending_delete' item.id %}" style="display:inline;">
                            {% csrf_token %}
                            <button class="btn small ghost">üóëÔ∏è</button>
                        </form>
                    </td>

                </tr>
                {% endfor %}
            </tbody>
        </table>

    </form>

</div>

<style>
    .small-input {
        width: 140px;
        padding: 6px;
        font-size: 13px;
    }

    .name-input {
        width: 300px;
        /* —à–∏—Ä—à–µ –ø–æ–ª–µ –¥–ª—è –Ω–∞–∑–≤–∏ */
        padding: 6px;
        font-size: 13px;
    }

    td {
        vertical-align: middle;
    }

    .btn {
        padding: 8px 16px;
        border-radius: 6px;
        border: none;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
        transition: background 0.2s, color 0.2s;
    }

    .btn.primary {
        background-color: #2563eb;
        color: #fff;
    }

    .btn.primary:hover {
        background-color: #1e40af;
    }

    .btn.danger {
        background-color: #ef4444;
        color: #fff;
    }

    .btn.danger:hover {
        background-color: #b91c1c;
    }

    .btn-group button+button {
        margin-left: 8px;
    }
</style>

<script>
    document.getElementById("check-all").addEventListener("change", function () {
        document.querySelectorAll(".row-check").forEach(c => c.checked = this.checked);
    });
</script>

{% endblock %}