{% extends "base.html" %}
{% block title %}Pracownicy{% endblock %}
{% block page_title %}Pracownicy{% endblock %}
{% block page_subtitle %}Lista pracownik√≥w, wyszukiwanie i filtry{% endblock %}
{% block topbar_actions %}
  <a href="{% url 'employees:add' %}" class="btn primary small">DODAJ PRACOWNIKA</a>
{% endblock %}

{% block content %}
<div class="card">
  <form method="get" class="filter-row" action="">
    <div>
      <label>Firma</label><br>
      <select name="company">
        <option value="">Wszystkie</option>
        {% for c in companies %}
        <option value="{{ c.id }}" {% if request.GET.company == c.id|stringformat:"s" %}selected{% endif %}>{{ c.name }}</option>
        {% endfor %}
      </select>
    </div>

    <div>
      <label>Stanowisko</label><br>
      <select name="position">
        <option value="">Wszystkie</option>
        {% for p in positions %}
        <option value="{{ p.id }}" {% if request.GET.position == p.id|stringformat:"s" %}selected{% endif %}>{{ p.name }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="search">
      <input type="text" name="q" placeholder="nr karty / imiƒô / nazwisko" value="{{ request.GET.q }}">
      <button type="submit" class="btn ghost small">üîç</button>
    </div>
    
  </form>
</div>

<div class="card">
  <table class="table">
    <thead>
      <tr>
        <th>NR Karty</th>
        <th>Nazwisko</th>
        <th>Imiƒô</th>
        <th>Stanowisko</th>
        <th>Dzia≈Ç</th>
        <th>Firma</th>
        <th>Akcje</th>
      </tr>
    </thead>
    <tbody>
      {% for emp in employees %}
      <tr>
        <td>{{ emp.card_number }}</td>
        <td>{{ emp.last_name }}</td>    
        <td>{{ emp.first_name }}</td>
        <td>{{ emp.position.name }}</td>
        <td>{{ emp.department.name }}</td>
        <td>{{ emp.company.name }}</td>
        <td class="actions">
          <a href="{% url 'employees:detail' emp.id %}" class="btn small" title="Szczeg√≥≈Çy pracownika">üìÇ</a>
          <a href="{% url 'employees:edit' emp.id %}" class="btn small" title="Edytuj pracownika">‚úèÔ∏è</a>
          <form method="post" action="{% url 'employees:delete' emp.id %}" style="display:inline;">
            {% csrf_token %}
            <button class="btn small" onclick="return confirm('UsunƒÖƒá pracownika?')" title="Usu≈Ñ pracownika">ü™£</button>
          </form>
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="7">Brak pracownik√≥w</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}