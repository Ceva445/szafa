{% extends "base.html" %}
{% block title %}Przyjęcia zewnętrzne{% endblock %}
{% block page_title %}Dokumenty PZ{% endblock %}
{% block page_subtitle %}Lista przyjęć zewnętrznych{% endblock %}
{% block topbar_actions %}
  <a href="{% url 'documents:create_pz' %}" class="btn small">➕ Nowe PZ</a>
{% endblock %}

{% block content %}
<div class="card">
  <form method="get" class="filter-row" style="align-items:center;">
    <input type="text" name="q" placeholder="Szukaj (nr dokumentu / dostawca / odbiorca)" value="{{ q }}">
    
    <select name="supplier">
      <option value="">Wszyscy dostawcy</option>
      {% for s in suppliers %}
      <option value="{{ s.id }}" {% if supplier == s.id|stringformat:"s" %}selected{% endif %}>{{ s.name }}</option>
      {% endfor %}
    </select>

    <select name="recipient">
      <option value="">Wszyscy odbiorcy</option>
      {% for r in recipients %}
      <option value="{{ r.id }}" {% if recipient == r.id|stringformat:"s" %}selected{% endif %}>{{ r.name }}</option>
      {% endfor %}
    </select>

    <button class="btn primary small">Szukaj</button>
  </form>
</div>

<div class="card">
  <table class="table">
    <thead>
      <tr>
        <th>Nr dokumentu</th>
        <th>Data</th>
        <th>Dostawca</th>
        <th>Odbiorca</th>
        <th>Pozycje</th>
        <th>Akcje</th>
      </tr>
    </thead>
    <tbody>
      {% for d in documents %}
      <tr>
        <td>{{ d.document_number }}</td>
        <td>{{ d.issue_date }}</td>
        <td>{{ d.supplier.name }}</td>
        <td>{{ d.recipient.name }}</td>
        <td>{{ d.items.count }}</td>
        <td>
          <a class="btn small" href="{% url 'documents:pz_detail' d.id %}">Szczegóły</a>
          <a class="btn small" href="{% url 'documents:edit_pz' d.id %}">✏️</a>
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="6">Brak PZ</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
